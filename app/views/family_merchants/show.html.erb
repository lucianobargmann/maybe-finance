<header class="flex items-center justify-between">
  <div class="flex items-center gap-3">
    <% if @family_merchant.logo_url %>
      <div class="w-10 h-10 rounded-full flex justify-center items-center">
        <%= image_tag @family_merchant.logo_url, class: "w-10 h-10 rounded-full" %>
      </div>
    <% else %>
      <%= render partial: "shared/color_avatar", locals: { name: @family_merchant.name, color: @family_merchant.color, size: "lg" } %>
    <% end %>
    <h1 class="text-primary text-xl font-medium"><%= @family_merchant.name %></h1>
  </div>

  <div class="flex items-center gap-2">
    <%= render DS::Link.new(
      text: t(".edit"),
      variant: "outline",
      icon: "pencil",
      href: edit_family_merchant_path(@family_merchant),
      frame: :modal
    ) %>
  </div>
</header>

<div class="bg-container rounded-xl shadow-border-xs p-4">
  <div class="mb-4">
    <h2 class="text-primary font-medium"><%= t(".transactions") %></h2>
    <p class="text-secondary text-sm"><%= t(".transactions_description", count: @transactions.count) %></p>
  </div>

  <% if @transactions.any? %>
    <div class="rounded-xl bg-container-inset space-y-1 p-1">
      <div class="bg-container rounded-lg shadow-border-xs">
        <div class="overflow-hidden rounded-lg">
          <% @transactions.each_with_index do |transaction, index| %>
            <div class="flex justify-between items-center p-4 bg-container">
              <div class="flex items-center gap-3">
                <div class="flex flex-col">
                  <%= link_to transaction.entry.name,
                      transaction_path(transaction.entry),
                      data: { turbo_frame: "drawer" },
                      class: "text-primary text-sm font-medium hover:underline" %>
                  <p class="text-secondary text-xs"><%= transaction.entry.date.strftime("%d/%m/%Y") %></p>
                </div>
              </div>
              <div class="text-right">
                <p class="font-medium <%= transaction.entry.amount.negative? ? 'text-success' : 'text-destructive' %>">
                  <%= format_money transaction.entry.amount_money %>
                </p>
                <% if transaction.category %>
                  <p class="text-secondary text-xs"><%= transaction.category.name %></p>
                <% end %>
              </div>
            </div>
            <% unless index == @transactions.length - 1 %>
              <%= render "shared/ruler" %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>

    <div class="mt-4">
      <%= render DS::Link.new(
        text: t(".view_all"),
        variant: "outline",
        full_width: true,
        href: transactions_path(q: { merchants: [@family_merchant.name] }),
        frame: :_top
      ) %>
    </div>
  <% else %>
    <div class="flex justify-center items-center py-20">
      <div class="text-center">
        <p class="text-secondary text-sm"><%= t(".no_transactions") %></p>
      </div>
    </div>
  <% end %>
</div>
